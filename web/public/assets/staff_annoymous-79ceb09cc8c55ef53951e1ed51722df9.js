function setRoomhistory(o,s){$("#msgs").empty().append('<div class="span12" id="roomhistory_blank">&nbsp;</div>'),s.forEach(function(o){var s=0==o.indexOf("debbie:");$("#msgs").append('<div class="span12 msg-row '+(s?"":"right")+'"><span class=" badge">'+o+"</span></div>")})}function addRoommsg(o,s){var e=0==s.indexOf("debbie:");o==selected_roomid?$("#roomhistory_blank").after('<div class="span12 msg-row '+(e?"":"right")+'"><span class=" badge">'+s+"</span></div>"):alert("got msg"+s)}function roomclick(o){selected_roomid=o,socket.emit("room.fetchhistory",{roomid:o})}function sendmsg(){var o=$("#msgtosend").val();socket.emit("room.msgput",{roomid:selected_roomid,msg:o})}var socket=io.connect("http://localhost:8087"),selected_roomid=null,name=Math.random();socket.emit("app.tologin",{name:name}),socket.on("app.login",function(){socket.on("room.create",function(o){selected_roomid=o.roomid,$("#flush").html("已链接至客服")}),socket.on("room.msg",function(o){addRoommsg(o.roomid,o.msg)})});